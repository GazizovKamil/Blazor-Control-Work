@page "/profile"

<PageTitle>Profile</PageTitle>

@using Blazor_Control_Work.Data
@using EditorUnit

@inject NavigationManager NavigationManager
@inject SingletonService SingletonService

<section class="vh-100" style="background-color: #eee;">
    <div class="container py-5 h-100">
        <div class="row d-flex justify-content-center align-items-center h-100">
            <div class="col-md-12 col-xl-4">

                <div class="card" style="border-radius: 15px;">
                    <div class="card-body text-center">
                        @if (SingletonService.user != null)
                        {
                            <div class="mt-3 mb-4">
                              <img src=""
                                class="rounded-circle img-fluid" style="width: 100px;" />
                            </div>

                            <div class="d-flex justify-content-center">
                                <div class="btn btn-primary btn-rounded btn-lg" @onclick="PhotoSave">
                             </div>
                                <input type="file" @bind="namePhoto">
                            </div>

                            <h4 class="mb-2">@SingletonService.user.Name  @SingletonService.user.Surname</h4>
                            <p class="text-muted mb-4">
                                <a href="#!">@SingletonService.user.Email</a>
                            </p>
                        }
                        <button type="button" @onclick="Output" class="btn btn-primary btn-rounded btn-lg">
                            Output
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@code {
    string namePhoto;

    public void PhotoSave()
    {
        FileSystemService fileSystemService = new FileSystemService();
        string[] path = namePhoto.Split('\\');
        namePhoto = path[path.Length-1];
    }

    public void PhotoLoad()
    {
        FileSystemService fileSystemService = new FileSystemService();
        fileSystemService.DownloadToLocal(SingletonService.user.Name);
    }


    public void Output()
    {
        User user = null;
        SingletonService.SetUser(user);
        NavigationManager.NavigateTo("/");
    }
}
